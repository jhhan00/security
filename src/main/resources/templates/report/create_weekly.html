<!DOCTYPE html>
<html lang="en"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Create Weekly</title>
    <link rel="stylesheet" href="/bootstrap.css">
    <link rel="stylesheet" href="/bootstrap-grid.css">
    <link rel="stylesheet" href="/bootstrap-reboot.css">
    <link rel="stylesheet" type="text/css" href="/board.css">

    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function() {
           $("#plan").show();
           $("#after").hide();

           $("input[name=select]").change(function() {
              var value = $(this).val();
              if(value == "plan") {
                  $("#plan").show();
                  $("#after").hide();
              } else if(value == "after") {
                  $("#plan").hide();
                  $("#after").show();
              }
           });
        });

        var count = 0;
        function plan_add() {
            var addedform = document.getElementById('plan_div');
            var str =
                "<label>Weekly_Plan</label>"+
                "<input type=\"text\" name=\"plan" + count + "\"/>" +
                "<label>Expected Achievement</label>" +
                "<input type='number' placeholder='1~100' min='1' max='100' name='achievement" + count + "'/><br/>" +
                "<label>Description</label><br/>" +
                "<textarea type='text' placeholder='최대 6000자' cols='30' name='comment" + count + "'></textarea>";
            var div = document.createElement('div');
            div.id="plan" + count;
            div.innerHTML = str;
            addedform.appendChild(div);

            count++; console.log(count);
        }
        function plan_delete() {
            console.log(count);
            if(count > 1) {
                var addedDiv = document.getElementById("plan" + (--count));
                document.getElementById('plan_div').removeChild(addedDiv);
            }
        }

        var check = 0;
        function result_add() {
            var addedform = document.getElementById('result_div');
            var str =
                "<label>Other Result</label>" +
                "<input type='text' name='result" + check + "'/>" +
                "<label>Achievement</label>" +
                "<input type='number' placeholder='1~100' min='1' max='100' name='achievement" + check + "'/><br/>" +
                "<label>Comment</label><br/>" +
                "<textarea type='text' placeholder='최대 6000자' cols='30' name='description" + check + "'></textarea>";
            var div = document.createElement('div');
            div.id="result" + check;
            div.innerHTML = str;
            addedform.appendChild(div);

            check++; console.log(check);
        }
        function result_delete() {
            console.log(check);
            if(check > 1) {
                var addedDiv = document.getElementById(("result" + (--check)));
                document.getElementById('result_div').removeChild(addedDiv);
            }
        }
    </script>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container">
            <a class="navbar-brand" href="/">Main</a>
            <a class="navbar-brand" href="/report">Back</a>
        </div>
    </nav>
    <div class="container">
        <div>
            <div class="t-c">
                <span th:text="${authority.username}">username</span>, Welcome!
<!--                <span th:text="${authority.realName}">realname</span>-->
<!--                <span th:text="${authority.role}">role</span>-->
            </div>
        </div>
        <hr/>
        <h5>create weekly</h5>
        <div>
            <div>
                <label><input type="radio" name="select" value="plan" checked="checked"> weekly_plan</label>
                <label><input type="radio" name="select" value="after"> weekly_result</label>
            </div>
            <div id="plan">
                PLAN
                <form th:object="${task}" method="post" action="/report/create/weekly">
                    <input type="hidden" name="planOrAfter" value="plan"/>
                    <div>
                        <div id="plan_div"></div>
                        <input type="button" value="Add" onclick="plan_add()"/>
                        <input type="button" value="Delete" onclick="plan_delete()"/>
                    </div><br/>
                    <div th:if="${Valid} == false">
                        <button class="btn btn-primary" type="submit">Submit</button>
                    </div>
                </form>
            </div>
            <div id="after">
                After
                <form th:object="${task}" method="post" action="/report/create/weekly">
                    <input type="hidden" name="planOrAfter" value="after"/>
                    <div th:each="plan, i:${task}">
                        <div th:unless="${plan.progress} == null">
                            <label>Progress</label>
                            <input type="text" th:name="${'plan'+i.index}" th:value="${plan.progress}" readonly>
                            <label>Achievement</label>
                            <input type="number" min="1" max="100" th:name="${'achieve'+i.index}" th:value="${plan.expectedAchievement}"/><br/>
                            <label>Comment</label><br/>
                            <textarea type="text" placeholder="최대 6000자" cols="30" th:name="${'comment'+i.index}"></textarea>
                        </div>
                    </div>
                    <div>
                        <div id="result_div"></div>
                        <input type="button" value="Add" onclick="result_add()"/>
                        <input type="button" value="Delete" onclick="result_delete()"/>
                    </div>
                    <br/>
                    <div th:if="${Valid} == true">
                        <button class="btn btn-primary" type="submit">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</body>
</html>